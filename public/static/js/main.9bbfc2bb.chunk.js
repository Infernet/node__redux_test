(window.webpackJsonpnode_with_react=window.webpackJsonpnode_with_react||[]).push([[0],{42:function(e,t,n){e.exports=n(71)},47:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(21),c=n.n(r);n(47),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=n(1),i=n(2),l=n(4),u=n(3),p=n(5),m=n(8),h=n(18),d=n(17),g=n(9),E=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=n.onChange.bind(Object(g.a)(n)),n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onChange",value:function(e){this.props.setValue(e.target.value)}},{key:"render",value:function(){return s.a.createElement("div",{className:"block"+this.props.class},s.a.createElement("label",{htmlFor:"login",className:"label"+this.props.class},"Login"),s.a.createElement("input",{type:"text",id:"login",name:"login",className:"input"+this.props.class,onChange:this.onChange,placeholder:this.props.login,autoComplete:"false"}))}}]),t}(s.a.Component),b=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=n.onChange.bind(Object(g.a)(n)),n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onChange",value:function(e){this.props.setValue(e.target.value)}},{key:"render",value:function(){return s.a.createElement("div",{className:"block"+this.props.class},s.a.createElement("label",{htmlFor:"password",className:"label"+this.props.class},"Password"),s.a.createElement("input",{type:"password",id:"password",name:"password",className:"input"+this.props.class,onChange:this.onChange,placeholder:this.props.password,autoComplete:"false"}))}}]),t}(s.a.Component),f=n(7),O=n.n(f),j="CHANGE_LOGIN",y="CHANGE_PASSWORD",k="SIGN_IN_SUCCESS",v="SIGN_IN_REQUEST",_="SIGN_IN_FAILED",S="SIGN_OUT",T=n(14),N=n.n(T),U=n(38),C=n.n(U),w=n(19),I={id:null,role:0,login:"",password:"",isFetching:!1,message:""};var R="CLEAR_USER_DATA",A="GET_USERS_REQUEST",F="GET_USERS_SUCCESS",D="GET_USERS_FAILED",L="CHANGE_USER",q="INSERT_USER_REQUEST",H="INSERT_USER_SUCCESS",x="INSERT_USER_FAILED",P="UPDATE_USER_REQUEST",G="UPDATE_USER_SUCCESS",K="UPDATE_USER_FAILED",z="DELETE_USER_REQUEST",Q="DELETE_USER_SUCCESS",B="DELETE_USER_FAILED",M={selectedId:null,users:[],isFetching:!1,message:"",user:{login:"",password:"",email:"",firstName:"",lastName:""}};var W="SIGN_OUT_TOKEN",V="RESTORE_TOKEN",J="CLEAR_TOKEN_DATA",Y="SET_TOKENS",$="AUTH_WITH_TOKEN_REQUEST",X="AUTH_WITH_TOKEN_SUCCESS",Z="AUTH_WITH_TOKEN_FAILED",ee="REFRESH_TOKEN_REQUEST",te="REFRESH_TOKEN_SUCCESS",ne="REFRESH_TOKEN_FAILED",ae={accessToken:null,refreshToken:null,accessExpiresIn:0,isFetching:!1,message:""};var se=Object(w.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object.assign({},e,{login:t.payload});case y:return Object.assign({},e,{password:t.payload});case v:return Object.assign({},e,{isFetching:!0});case k:return Object.assign({},e,t.payload,{password:"",isFetching:!1});case _:return Object.assign({},e,t.payload,{isFetching:!1});case S:return Object.assign({},I);default:return e}},tokenAuth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return Object.assign({},ae);case Y:return Object.assign({},e,t.payload);case J:return Object.assign({},ae);case V:return Object.assign({},e,t.payload);case $:return Object.assign({},e,t.payload,{isFetching:!0,message:"token auth request"});case X:return Object.assign({},e,t.payload,{isFetching:!1,message:"token auth success"});case Z:return Object.assign({},ae,{message:"token auth failed"});case ee:return Object.assign({},e,t.payload,{isFetching:!0,message:"refresh token request"});case te:return Object.assign({},e,t.payload,{isFetching:!1,message:"refresh token success"});case ne:return Object.assign({},ae,{message:"refresh token failed"});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return Object.assign({},e,{selectedId:t.payload});case R:return Object.assign({},e,{user:M.user});case A:return Object.assign({},e,{isFetching:!0,message:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445"});case q:return Object.assign({},e,{isFetching:!0,message:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435"});case P:return Object.assign({},e,{isFetching:!0,message:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435"});case z:return Object.assign({},e,{isFetching:!0,message:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435"});case F:return Object.assign({},e,{users:t.payload});case H:return Object.assign({},e,{users:t.payload,isFetching:!0,message:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435"});case G:return Object.assign({},e,{users:t.payload,isFetching:!0,message:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435"});case Q:return Object.assign({},e,{users:t.payload,isFetching:!0,message:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435"});case x:case K:case B:case D:return Object.assign({},e,{isFetching:!0,message:t.message,users:[]});default:return e}}}),re=n(39),ce=n.n(re),oe=n(40),ie=Object(w.d)(se,Object(w.a)((function(e){return function(t){return function(n){if(n.type===A){alert(A);var a=e.getState().tokenAuth,s=Math.floor((new Date).getTime()/1e3);a.accessExpiresIn<=s?t(n):(console.log("\u0442\u043e\u043a\u0435\u043d \u0435\u0449\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439"),t(n))}else console.log("\u041d\u0435 \u0442\u043e\u0442 action"),t(n)}}}),oe.a,ce.a));function le(){return function(e){e({type:$});var t=ie.getState().tokenAuth,n=Math.floor((new Date).getTime()/1e3);null!==t.accessToken?n<=t.accessExpiresIn?N.a.post("/request/login/token-auth",{},{headers:{authorization:"Bearer "+t.accessToken}}).then((function(t){if(200!==t.status)throw new Error;e({type:X}),e({type:k,payload:t.data.user})})).catch((function(t){401===t.status?(e({type:Z}),ue(le)):e({type:Z})})):(e({type:Z}),ue(le)):(localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),e({type:Z}))}}function ue(e){return function(t){var n=ie.getState().tokenAuth,a=JSON.parse(atob(n.accessToken.split(".")[1]));null!==n.refreshToken?(t({type:ee}),N.a.post("/request/login/refresh-token",{},{headers:{refresh:"Bearer "+n.refreshToken,userId:a.id}}).then((function(n){if(200!==n.status)throw new Error;t({type:te,payload:n.data}),t(e())})).catch((function(e){401===e.status?(localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),t({type:ne}),t({type:S})):t({type:ne})}))):(localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),t({type:ne}),t({type:S}))}}function pe(){return function(e){var t=localStorage.getItem("accessToken"),n=localStorage.getItem("refreshToken");null!==t&&null!==n?(e({type:V,payload:{accessToken:t,refreshToken:n}}),e(le())):(e({type:R}),e({type:J}))}}var me=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement(h.b,{exact:this.props.exact,className:"nav__link",activeClassName:"nav__link__active",to:this.props.link},this.props.name)}}]),t}(s.a.Component),he=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("nav",{className:"nav-bar"},s.a.createElement("div",{className:"nav-bar__container"},s.a.createElement(me,{exact:!0,link:"/",name:"Home page"}),s.a.createElement(me,{link:"/login",name:"Login"}),s.a.createElement(me,{link:"/authenticated",name:"Authenticated"}),s.a.createElement(me,{link:"/users",name:"User list"})))}}]),t}(s.a.Component),de=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"header"},s.a.createElement("img",{src:"/react-gif.gif",alt:""}))}}]),t}(s.a.Component),ge=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("footer",{className:"footer"},s.a.createElement("div",{className:"footer--logo"},s.a.createElement("img",{src:"/logo192.png",alt:""})),s.a.createElement("div",{className:"footer--content"},s.a.createElement("p",null,"\xa9 design by Infernet")))}}]),t}(s.a.Component),Ee=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=n.handleSubmit.bind(Object(g.a)(n)),n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.signIn({login:this.props.login,password:this.props.password})}},{key:"render",value:function(){var e=this.props,t=e.setLogin,n=e.setPassword,a=e.login,r=e.password,c=e.isFetching,o=e.message;return s.a.createElement("div",null,s.a.createElement(de,null),s.a.createElement(he,null),s.a.createElement("div",{className:"authorization-body"},s.a.createElement("div",{className:"authorization__title"},s.a.createElement("h3",null,"Login Page")),s.a.createElement("div",{className:"authorization__content"},s.a.createElement("form",{className:"authorization__content--form",onSubmit:this.handleSubmit},s.a.createElement(E,{login:a,setValue:t,class:"Login"}),s.a.createElement(b,{password:r,class:"Password",setValue:n}),s.a.createElement("button",{type:"submit"},"sign in")),s.a.createElement("div",{className:"authorization__content--status"},s.a.createElement("p",null,"Login: ",a),s.a.createElement("p",null,"Password: ",r),c?s.a.createElement("p",null,"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u043d\u0430 Node.js..."):s.a.createElement("p",null,o)))),s.a.createElement(ge,null))}}]),t}(s.a.Component);Ee.propsTypes={isFetching:O.a.bool.isRequired,message:O.a.string,login:O.a.string.isRequired,password:O.a.string.isRequired,setLogin:O.a.func.isRequired,setPassword:O.a.func.isRequired};var be=Object(m.b)((function(e){return console.log(e),{login:e.user.login,password:e.user.password,isFetching:e.user.isFetching,message:e.user.message}}),(function(e){return{setLogin:function(t){return e(function(e){return{type:j,payload:e}}(t))},setPassword:function(t){return e(function(e){return{type:y,payload:e}}(t))},signIn:function(t){return e((function(e){e({type:v});var t=ie.getState().user;C.a.getV18((function(n){N.a.post("/request/login/login-auth",{login:t.login,password:t.password,fingerPrint:n}).then((function(t){200===t.status&&(localStorage.setItem("accessToken",t.data.accessToken),localStorage.setItem("refreshToken",t.data.refreshToken),e({type:Y,payload:{accessToken:t.data.accessToken,refreshToken:t.data.refreshToken,accessExpiresIn:t.data.accessExpiresIn}}),e({type:k,payload:{id:t.data.id,login:t.data.login,role:t.data.role}}))})).catch((function(t){return e({type:_})}))}))}))}}}))(Ee),fe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:this.props.class.container},s.a.createElement("p",{className:this.props.class.title},this.props.title),s.a.createElement("p",{className:this.props.class.content},this.props.content))}}]),t}(s.a.Component),Oe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.store,t={container:"home__content--container",title:"home__content--title",content:"home__content--content"};return s.a.createElement("div",null,s.a.createElement(de,null),s.a.createElement(he,null),s.a.createElement("div",{className:"home-body"},s.a.createElement("div",{className:"home__title"},s.a.createElement("h3",null,"Home page")),s.a.createElement("div",{className:"home__content"},null!==e.tokenAuth.token?Object.keys(e.user).map((function(n){if("token"!==n&&""!==e.user[n])return s.a.createElement(fe,{key:n,class:t,title:n+":",content:e.user[n]})})):s.a.createElement(fe,{class:t,title:"\u041e\u0448\u0438\u0431\u043a\u0430:",content:"\u0412\u044b \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u044b"}))),s.a.createElement(ge,null))}}]),t}(s.a.Component),je=Object(m.b)((function(e){return{store:e}}))(Oe),ye=function(e){function t(e){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.store;return s.a.createElement("div",null,s.a.createElement(de,null),s.a.createElement(he,null),s.a.createElement("div",{className:"authenticated-body"},s.a.createElement("div",{className:"authenticated--title"},s.a.createElement("h3",null,"Authenticated page")),s.a.createElement("ul",{className:"authenticated--content"},Object.keys(e.user).map((function(t){return"token"!==t&&s.a.createElement("li",{key:t},t,": ",e.user[t])}))),s.a.createElement("button",{className:"authenticated--button",onClick:this.props.signOut},"Log out")),s.a.createElement(ge,null))}}]),t}(s.a.Component),ke=Object(m.b)((function(e){return{store:e}}),(function(e){return{signOut:function(){return e(function e(){return function(t){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken");var n=ie.getState().tokenAuth;N.a.post("/request/login/sign-out",{},{headers:{access:"Bearer "+n.accessToken,refresh:"Bearer "+n.refreshToken}}).then((function(e){if(200!==e.status)throw new Error;t({type:S}),t({type:W})})).catch((function(n){401===n.status?t(ue(e())):(t({type:S}),t({type:W}))}))}}())}}}))(ye),ve=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onInsertUser=n.onInsertUser.bind(Object(g.a)(n)),n.onUpdateUser=n.onUpdateUser.bind(Object(g.a)(n)),n.onDeleteUser=n.onDeleteUser.bind(Object(g.a)(n)),n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onInsertUser",value:function(e){}},{key:"onUpdateUser",value:function(e){}},{key:"onDeleteUser",value:function(e){}},{key:"render",value:function(){return s.a.createElement("div",{className:"users__control-panel--container"},s.a.createElement("button",{className:"users__control-panel--btn",onClick:this.onInsertUser},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),s.a.createElement("button",{className:"users__control-panel--btn",onClick:this.onUpdateUser},"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"),s.a.createElement("button",{className:"users__control-panel--btn",onClick:this.onDeleteUser},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))}}]),t}(s.a.Component);ve.propsTypes={user:O.a.object.isRequired};var _e=Object(m.b)((function(e){return{store:e}}),(function(e){return{insertUser:function(t){return e(le())}}}))(ve);function Se(e){return{type:L,payload:e}}function Te(){return function(e){e({type:A});var t=ie.getState().tokenAuth;Math.floor((new Date).getTime()/1e3)<t.accessExpiresIn?N.a.post("/request/user/get",{token:t.accessToken}).then((function(t){switch(t.status){case 200:e({type:F,payload:t.data.users});break;case 401:e({type:D}),e(ue(Te));break;default:e({type:D})}})).catch((function(t){401===t.status?(e({type:D}),e(ue(Te))):e({type:D})})):e(ue(Te))}}var Ne=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onSelect=n.onSelect.bind(Object(g.a)(n)),n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onSelect",value:function(e){e.preventDefault(),this.props.select(this.props.user.id)}},{key:"render",value:function(){var e=this.props.user;return s.a.createElement(h.b,{to:"",onClick:this.onSelect,className:"users__list--item-container",activeClassName:"users__list--item--container__active"},Object.keys(e).map((function(t){return s.a.createElement("p",{className:"users__list--item-content",key:t},e[t])})))}}]),t}(s.a.Component);Ne.propsTypes={user:O.a.object.isRequired,select:O.a.func.isRequired};var Ue=Ne,Ce=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.getUsers()}},{key:"render",value:function(){var e=this,t=this.props.store.users;return s.a.createElement("div",null,s.a.createElement(de,null),s.a.createElement(he,null),t.length>0?s.a.createElement("div",{className:"users-body"},s.a.createElement(_e,{user:t[0]}),s.a.createElement("div",{className:"users__list-header"},Object.keys(t[0]).map((function(e){return s.a.createElement("p",{className:"users__list-header--title",key:e},e)}))),t.map((function(t){return s.a.createElement(Ue,{user:t,key:t.id,select:e.props.selectUser})}))):s.a.createElement("div",{style:{height:"100%",width:"100%",display:"flex"}},s.a.createElement("h1",{style:{color:"black",margin:"auto"}},"EMPTY RESULT")),s.a.createElement(ge,null))}}]),t}(s.a.Component),we=Object(m.b)((function(e){return{store:e.users}}),(function(e){return{getUsers:function(){return e(Te())},selectUser:function(t){return e(Se(t))}}}))(Ce),Ie=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.store.accessToken;return s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/",exact:!0,component:je}),null!==e?s.a.createElement(d.a,{from:"/login",to:"/authenticated"}):s.a.createElement(d.a,{from:"/authenticated",to:"/login"}),null===e&&s.a.createElement(d.a,{from:"/users",to:"/login"}),s.a.createElement(d.b,{path:"/login",component:be}),s.a.createElement(d.b,{path:"/authenticated",component:ke}),s.a.createElement(d.b,{path:"/users",component:we}))}}]),t}(s.a.Component),Re=Object(m.b)((function(e){return{store:e.tokenAuth}}))(Ie),Ae=function(e){function t(e){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){null===this.props.tokenStore.accessToken&&null===this.props.tokenStore.refreshToken&&pe()}},{key:"render",value:function(){return s.a.createElement(h.a,null,s.a.createElement(Re,null))}}]),t}(s.a.Component);Ae.propsTypes={authorization:O.a.object.isRequired};var Fe=Object(m.b)((function(e){return{authorization:e.authorization,tokenStore:e.tokenAuth}}),(function(e){return{bearerToken:function(t){return e(le())},restoreToken:function(){return e(pe())}}}))(Ae);c.a.render(s.a.createElement(m.a,{store:ie},s.a.createElement(Fe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[42,1,2]]]);
//# sourceMappingURL=main.9bbfc2bb.chunk.js.map